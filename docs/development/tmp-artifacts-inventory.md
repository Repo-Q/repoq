# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ (tmp/)

**–°—Ç–∞—Ç—É—Å**: üîÑ Work in Progress  
**–¶–µ–ª—å**: –§–∏–∫—Å–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-10-21

---

## –û–±–∑–æ—Ä

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `tmp/` —Å–æ–¥–µ—Ä–∂–∏—Ç **—Ç—Ä–∏** –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:

1. **`repoq-meta-loop-addons/`** ‚Äî –û–Ω—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –º–µ—Ç–∞-–ø–µ—Ç–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ (19 —Ñ–∞–π–ª–æ–≤)
2. **`zag_repoq-finished/`** ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZAG (PCQ/PCE) (51 —Ñ–∞–π–ª)
3. **`repoq-any2math-integration/`** ‚Äî Proof-carrying –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Lean (7 —Ñ–∞–π–ª–æ–≤)

**–ò—Ç–æ–≥–æ: 77 —Ñ–∞–π–ª–æ–≤** –≥–æ—Ç–æ–≤—ã—Ö –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

–≠—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≥–æ—Ç–æ–≤—è—Ç—Å—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–¥–æ–≤—É—é –±–∞–∑—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–ª–∞–Ω–æ–º –∏–∑:
- `docs/development/ontology-alignment-report.md`
- `docs/development/quality-loop-roadmap.md`
- `docs/development/mathematical-proof-quality-monotonicity.md`
- `docs/development/formal-foundations-complete.md` (Section 15)
- `docs/development/formal-diagrams.md` (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π)

---

## 1. repoq-meta-loop-addons/

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ **–æ–Ω—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–º–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è** –∏ **—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ self-application**.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tmp/repoq-meta-loop-addons/
‚îú‚îÄ‚îÄ README.md                           # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ META_QUALITY.md                 # –ö–æ–Ω—Ü–µ–ø—Ü–∏—è + –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã
‚îú‚îÄ‚îÄ ontologies/                         # Three-Ontology Architecture
‚îÇ   ‚îú‚îÄ‚îÄ code.ttl                        #   Code Ontology (AST, symbols, imports)
‚îÇ   ‚îú‚îÄ‚îÄ c4.ttl                          #   C4 Model Ontology (containers, components)
‚îÇ   ‚îú‚îÄ‚îÄ ddd.ttl                         #   DDD Ontology (bounded contexts, aggregates)
‚îÇ   ‚îú‚îÄ‚îÄ meta_context.jsonld             #   JSON-LD –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ–Ω—Ç–æ–ª–æ–≥–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ mappings.yaml                   #   –ú–∞–ø–ø–∏–Ω–≥ Code‚ÜíC4‚ÜíDDD
‚îú‚îÄ‚îÄ shapes/
‚îÇ   ‚îî‚îÄ‚îÄ meta_loop.ttl                   # SHACL: self-analysis guard, VC policies
‚îú‚îÄ‚îÄ trs/                                # Term Rewriting Systems (–ø—Ä–∞–≤–∏–ª–∞)
‚îÇ   ‚îú‚îÄ‚îÄ jsonld.json                     #   –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è JSON-LD –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ metrics.json                    #   –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –º–µ—Ç—Ä–∏–∫ (–º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ rdf.json                        #   RDF-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ semver.json                     #   Semantic Versioning –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îî‚îÄ‚îÄ spdx.json                       #   SPDX license –ø—Ä–∞–≤–∏–ª–∞
‚îú‚îÄ‚îÄ repoq/
‚îÇ   ‚îú‚îÄ‚îÄ cli_meta.py                     # CLI —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: meta-self, trs-verify
‚îÇ   ‚îî‚îÄ‚îÄ trs/
‚îÇ       ‚îî‚îÄ‚îÄ engine.py                   # TRS –¥–≤–∏–∂–æ–∫ (confluence, termination)
‚îú‚îÄ‚îÄ sparql/
‚îÇ   ‚îú‚îÄ‚îÄ inference_construct.rq          # SPARQL CONSTRUCT –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ quality_checks.rq               # –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞
‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ test_self_policy.py             # –¢–µ—Å—Ç—ã —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ self-application
    ‚îî‚îÄ‚îÄ test_trs_idempotence.py         # –¢–µ—Å—Ç—ã TRS –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1.1 Ontologies (Three-Ontology Architecture)

**Code Ontology** (`code.ttl`):
- –ö–ª–∞—Å—Å—ã: `code:Module`, `code:Class`, `code:Function`, `code:Variable`
- –°–≤–æ–π—Å—Ç–≤–∞: `code:imports`, `code:calls`, `code:defines`
- –¶–µ–ª—å: AST-—É—Ä–æ–≤–µ–Ω—å –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–¥–∞

**C4 Model Ontology** (`c4.ttl`):
- –ö–ª–∞—Å—Å—ã: `c4:Container`, `c4:Component`, `c4:Relationship`
- –°–≤–æ–π—Å—Ç–≤–∞: `c4:dependsOn`, `c4:contains`, `c4:exposes`
- –¶–µ–ª—å: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (—Å–∏—Å—Ç–µ–º—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)

**DDD Ontology** (`ddd.ttl`):
- –ö–ª–∞—Å—Å—ã: `ddd:BoundedContext`, `ddd:Aggregate`, `ddd:Entity`, `ddd:ValueObject`
- –°–≤–æ–π—Å—Ç–≤–∞: `ddd:contextBoundary`, `ddd:aggregateRoot`, `ddd:belongsTo`
- –¶–µ–ª—å: –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

**Mappings** (`mappings.yaml`):
```yaml
code_to_c4:
  - code:Module ‚Üí c4:Component (when: has public API)
  - code:Package ‚Üí c4:Container (when: deployment unit)

c4_to_ddd:
  - c4:Component ‚Üí ddd:BoundedContext (when: domain focus)
  - c4:Relationship ‚Üí ddd:ContextMap (when: cross-context)
```

#### 1.2 TRS Engine

**–¶–µ–ª—å**: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–≤—É–∫–æ–≤–æ–µ (sound) –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä.

**–ü—Ä–∞–≤–∏–ª–∞** (`trs/*.json`):
- –§–æ—Ä–º–∞—Ç: `{"lhs": pattern, "rhs": replacement, "conditions": [...]}`
- –°–≤–æ–π—Å—Ç–≤–∞: Confluence (Church-Rosser), Termination, Idempotence

**–î–≤–∏–∂–æ–∫** (`repoq/trs/engine.py`):
- `apply_rules(term, ruleset)` ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏
- `check_confluence(rules)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä (Knuth-Bendix)
- `normalize(term)` ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ

#### 1.3 SHACL Shapes

**Self-Application Guard** (`shapes/meta_loop.ttl`):
```turtle
:SelfAnalysisShape
    a sh:NodeShape ;
    sh:targetClass repo:SelfAnalysis ;
    sh:property [
        sh:path repo:stratificationLevel ;
        sh:minInclusive 0 ;
        sh:maxInclusive 2 ;
        sh:message "Stratification level must be 0-2"
    ] ;
    sh:property [
        sh:path repo:readOnlyMode ;
        sh:hasValue true ;
        sh:message "Self-analysis must be read-only"
    ] .
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤ —Å–∞–º–æ–∞–Ω–∞–ª–∏–∑–∞ (Russell's paradox analog).

#### 1.4 SPARQL Queries

**Inference** (`sparql/inference_construct.rq`):
```sparql
CONSTRUCT {
    ?component ddd:BoundedContext ?context .
}
WHERE {
    ?component a c4:Component .
    ?component c4:hasResponsibility ?resp .
    FILTER (regex(?resp, "Domain|Business"))
    BIND (IRI(CONCAT("http://example.org/context/", STR(?component))) AS ?context)
}
```

**Quality Checks** (`sparql/quality_checks.rq`):
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π DDD –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ë–ª–æ–∫–µ—Ä—ã |
|-----------|------------|-----------|---------|
| `code.ttl` | 80% | P1 | –ù—É–∂–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è Python AST |
| `c4.ttl` | 70% | P1 | –ê–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `ddd.ttl` | 60% | P2 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ heuristics –¥–ª—è BC |
| `trs/engine.py` | 90% | P0 | –ù–µ—Ç (–≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏) |
| `shapes/meta_loop.ttl` | 85% | P0 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å PySHACL |
| `cli_meta.py` | 75% | P1 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º CLI |
| Tests | 40% | P1 | –†–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ 80% |

### –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**Week 1-2** (Priority 0 ‚Äî Safety Guards):
1. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `trs/engine.py` ‚Üí `repoq/core/trs.py`
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `shapes/meta_loop.ttl` ‚Üí `repoq/shapes/`
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `SelfApplicationGuard` –≤ `repoq/gate.py`
4. ‚úÖ –¢–µ—Å—Ç—ã: `test_self_policy.py` ‚Üí `tests/test_safety.py`

**Week 2-4** (Priority 1 ‚Äî Basic Ontology):
1. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `ontologies/code.ttl` ‚Üí `repoq/ontologies/`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `BasicOntologyManager` –≤ `repoq/ontology/manager.py`
3. –î–æ–±–∞–≤–∏—Ç—å pattern detection (5-7 patterns)
4. –û–±–Ω–æ–≤–∏—Ç—å Q-–º–µ—Ç—Ä–∏–∫—É: `Q += architectural_bonus`

**Month 2** (Priority 2 ‚Äî Full Ontology):
1. –î–æ–±–∞–≤–∏—Ç—å `c4.ttl`, `ddd.ttl` –≤ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `SemanticInferenceEngine`
3. Cross-ontology –º–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ SPARQL

---

## 2. zag_repoq-finished/

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZAG** (Zero-Assumptions Guarantee) –¥–ª—è PCQ/PCE –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tmp/zag_repoq-finished/
‚îú‚îÄ‚îÄ README.md                           # ZAG integration guide
‚îú‚îÄ‚îÄ Dockerfile                          # Multi-stage build –¥–ª—è ZAG
‚îú‚îÄ‚îÄ Makefile                            # Build + test automation
‚îú‚îÄ‚îÄ pyproject.toml                      # Dependencies —Å ZAG SDK
‚îú‚îÄ‚îÄ repoq.yaml                          # ZAG manifest example
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ repoq.yml                       # CI/CD —Å ZAG validation
‚îú‚îÄ‚îÄ repoq/
‚îÇ   ‚îú‚îÄ‚îÄ cli.py                          # CLI —Å ZAG commands
‚îÇ   ‚îú‚îÄ‚îÄ config.py                       # ZAG config loader
‚îÇ   ‚îú‚îÄ‚îÄ logging.py                      # ZAG-aware logging
‚îÇ   ‚îú‚îÄ‚îÄ analyzers/                      # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã (6 —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ci_qm.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ complexity.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hotspots.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ structure.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weakness.py
‚îÇ   ‚îú‚îÄ‚îÄ certs/                          # VC Certificates + ZAG
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generator.py                #   –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VC
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ linker.py                   #   Linkage —Å ZAG claims
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pack.py                     #   Packaging –¥–ª—è ZAG
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ quality.py                  #   Quality scoring
‚îÇ   ‚îú‚îÄ‚îÄ core/                           # Core modules (4 —Ñ–∞–π–ª–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jsonld.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rdf_export.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repo_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ integrations/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ zag.py                      # ZAG SDK integration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ zag_schemas/                # JSON schemas
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pce_schema.json         #   PCE structure
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pcq_schema.json         #   PCQ structure
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ zag_manifest_schema.json #  Manifest schema
‚îÇ   ‚îú‚îÄ‚îÄ ontologies/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ context_ext.jsonld          # Extended JSON-LD context
‚îÇ   ‚îú‚îÄ‚îÄ reporting/                      # Reporting (3 —Ñ–∞–π–ª–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diff.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graphviz.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ markdown.py
‚îÇ   ‚îî‚îÄ‚îÄ shapes/
‚îÇ       ‚îî‚îÄ‚îÄ shacl_cert.ttl              # SHACL –¥–ª—è VC + ZAG
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 2.1 ZAG Manifest (`repoq.yaml`)

```yaml
version: "1.0"
project:
  name: "repoq"
  fairness:
    boundary: ["repoq/cli.py", "repoq/core/", "repoq/analyzers/"]
    mincut_budget: 150

pcq:
  aggregator: "min"  # ZAG min-aggregator –¥–ª—è PCQ
  threshold: 0.82
  support:
    - type: "module"
      path: "repoq/"
      weight: "loc"

pce:
  k: 5  # Top-5 hotspots
  witness_generation: "hotspot_ranking"
  remediation_plan: true
```

#### 2.2 PCQ/PCE Schemas

**PCQ Schema** (`zag_schemas/pcq_schema.json`):
```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "aggregator": {"enum": ["min", "max", "avg", "sum"]},
    "threshold": {"type": "number", "minimum": 0, "maximum": 1},
    "support": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "utility": {"type": "number", "minimum": 0, "maximum": 1}
        }
      }
    }
  }
}
```

**PCE Schema** (`zag_schemas/pce_schema.json`):
```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "claim": {"type": "string"},
    "k": {"type": "integer", "minimum": 1},
    "witness": {
      "type": "array",
      "items": {"type": "string"},
      "maxItems": {"$ref": "#/properties/k"}
    },
    "remediation_plan": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "target": {"type": "string"},
          "action": {"type": "string"},
          "expected_delta": {"type": "number"}
        }
      }
    }
  }
}
```

#### 2.3 Certificates + ZAG

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä VC** (`certs/generator.py`):
- –°–æ–∑–¥–∞—ë—Ç Verifiable Credentials —Å Q-–º–µ—Ç—Ä–∏–∫–æ–π
- –í–∫–ª—é—á–∞–µ—Ç ZAG attestation –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç `assuranceLevel`: `"ZAG:ACCEPT"` / `"GATE:WAIVED"`

**Quality Scoring** (`certs/quality.py`):
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ Q-–º–µ—Ç—Ä–∏–∫–∏ —Å —É—á—ë—Ç–æ–º PCQ
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ witness –¥–ª—è PCE
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è k-repair plans

#### 2.4 Docker + CI/CD

**Dockerfile**:
```dockerfile
FROM python:3.11-slim AS builder
WORKDIR /app
COPY pyproject.toml .
RUN pip install --no-cache-dir -e ".[full,zag]"

FROM python:3.11-alpine
COPY --from=builder /usr/local/lib/python3.11/site-packages /usr/local/lib/python3.11/site-packages
COPY --from=builder /usr/local/bin/repoq /usr/local/bin/
COPY repoq/ /app/repoq/
WORKDIR /app
ENTRYPOINT ["repoq"]
```

**GitHub Actions** (`.github/workflows/repoq.yml`):
```yaml
**GitHub Actions** (`.github/workflows/repoq.yml`):
```yaml
- name: Run Quality Gate
  run: |
    repoq gate \
      --base ${{ github.event.pull_request.base.sha }} \
      --head ${{ github.sha }} \
      --policy .github/quality-policy.yml \
      --zag-manifest repoq.yaml \
      --output gate-result.json
```

### 2.3 repoq-any2math-integration/

#### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Any2Math** (Lean 4 TRS) –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞—á–µ—Å—Ç–≤–∞ –∏ proof-carrying —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tmp/repoq-any2math-integration/
‚îú‚îÄ‚îÄ README.md                           # Smoke-—Ç–µ—Å—Ç –∏ —Å–±–æ—Ä–∫–∞ Lean
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ ANY2MATH_INTEGRATION.md         # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ repoq/
‚îÇ   ‚îú‚îÄ‚îÄ cli_any2math.py                 # CLI: any2math-normalize
‚îÇ   ‚îú‚îÄ‚îÄ plugins/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ trs_any2math.py             # –ü–ª–∞–≥–∏–Ω –¥–ª—è normalize + enrichment
‚îÇ   ‚îî‚îÄ‚îÄ integrations/
‚îÇ       ‚îî‚îÄ‚îÄ any2math/
‚îÇ           ‚îú‚îÄ‚îÄ adapter.py              # I/O-–∞–¥–∞–ø—Ç–µ—Ä –∫ Lean-–±–∏–Ω–∞—Ä–Ω–∏–∫—É
‚îÇ           ‚îú‚îÄ‚îÄ bridge.py               # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è: —Ç–µ–∫—Å—Ç/AST –∏ PCQ‚ÜíAST
‚îÇ           ‚îú‚îÄ‚îÄ scheduler.py            # Œµ-step heartbeat (liveness)
‚îÇ           ‚îî‚îÄ‚îÄ schemas/
‚îÇ               ‚îî‚îÄ‚îÄ expr.schema.json    # JSON Schema –¥–ª—è Any2Math AST
‚îî‚îÄ‚îÄ tests/
    ‚îî‚îÄ‚îÄ test_any2math_adapter.py        # Smoke-—Ç–µ—Å—Ç—ã (fallback)
```

#### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**Verified Mode** (—Å `ANY2MATH_BIN`):
```bash
export ANY2MATH_BIN=/path/to/any2math
python -m repoq.cli_any2math any2math-normalize "mul(one, add(zero, x))"
# Output: mode: "verified", normal_form: {"var":"x"}, proof.sha256: ...
```

**Fallback Mode** (–±–µ–∑ Lean):
```python
# –ú–∏–Ω–∏-TRS –≤–Ω—É—Ç—Ä–∏ RepoQ (—á–µ—Å—Ç–Ω–æ –ø–æ–º–µ—á–µ–Ω–Ω—ã–π –∫–∞–∫ TRS:FALLBACK)
res = adapter.normalize("add(zero, x)", mode="fallback")
# res.assurance_level == "TRS:FALLBACK"
```

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç Any2Math I/O**:

–í—Ö–æ–¥ (`in.json`):
```json
{
  "expr": {
    "app": "mul",
    "args": [
      {"app": "one", "args": []},
      {"app": "add", "args": [
        {"app": "zero", "args": []},
        {"var": "x"}
      ]}
    ]
  }
}
```

–í—ã—Ö–æ–¥ (`out.json`):
```json
{
  "normal_form": {"var": "x"}
}
```

–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ (`out.proof`):
- –§–æ—Ä–º–∞—Ç: olean/trace/json (–ª—é–±–æ–π)
- –ê–¥–∞–ø—Ç–µ—Ä –≤—ã—á–∏—Å–ª—è–µ—Ç SHA-256 –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ VC-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

**Œµ-Heartbeat Scheduler** (`scheduler.py`):
```python
class LivenessScheduler:
    """–ì–∞—Ä–∞–Ω—Ç–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ CI (–∞–Ω—Ç–∏-stall)."""
    
    def normalize_with_heartbeat(self, expr: str, epsilon_sec: float = 5.0):
        """–ü—Ä–µ—Ä—ã–≤–∞–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ Œµ —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ—Ç—á—ë—Ç–∞ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ."""
        # –†–µ–∞–ª–∏–∑—É–µ—Ç Œµ-step –∏–∑ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ (Liveness Lemma)
        pass
```

#### –§–æ—Ä–º–∞–ª—å–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏

1. **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã**: Confluence + Termination (–¥–æ–∫–∞–∑–∞–Ω–æ –≤ Lean) ‚Üí –ª—é–±—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è Q, PCQ well-defined
2. **–ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å –≤ –≥–µ–π—Ç–µ**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ $Q_{\text{head}}$ –∏ $Q_{\text{base}}$ –ø–æ –µ–¥–∏–Ω–æ–º—É –∫–∞–Ω–æ–Ω—É (–¢–µ–æ—Ä–µ–º–∞ A/B)
3. **Liveness**: Œµ-heartbeat scheduler ‚Üí –∞–Ω—Ç–∏-stall –¥–ª—è CI-–¥–∂–æ–±–æ–≤
4. **Proof-carrying**: SHA-256(proof) ‚Üí –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Å—ã–ª–æ—á–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–ª—è –∞—É–¥–∏—Ç–∞

#### –°—Ü–µ–ø–∫–∞ —Å VC-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

**–û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞**:
```python
from repoq.plugins.trs_any2math import TRSAny2MathPlugin

plug = TRSAny2MathPlugin()
res = plug.normalize_metric("add(zero, x)")

cert = {"type": "QualityCertificate"}
cert = plug.enrich_certificate(cert, res)
# cert["evidence"] += NormalizationEvidence
# cert["assuranceLevel"] = "TRS:VERIFIED" (–∏–ª–∏ "TRS:FALLBACK")
```

**JSON-LD –≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ**:
```json
{
  "evidence": [{
    "type": "NormalizationEvidence",
    "tool": "Any2Math-lean4",
    "proofHash": "sha256:a3f9...",
    "normalForm": {"var": "x"}
  }],
  "assuranceLevel": "TRS:VERIFIED",
  "prov:wasGeneratedBy": {
    "tool": "any2math",
    "version": "0.3.1-lean4.24.0",
    "commit": "abc123"
  }
}
```

#### CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**GitHub Actions** (`.github/workflows/any2math.yml`):
```yaml
- name: Normalize Q via Any2Math
  run: |
    export ANY2MATH_BIN=any2math  # –µ—Å–ª–∏ runner —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–Ω–∞—Ä—å
    python -m repoq.cli_any2math any2math-normalize "add(zero, x)"

- name: Quality Gate with Normalized Metrics
  run: |
    repoq gate \
      --base ${{ github.event.pull_request.base.sha }} \
      --head ${{ github.sha }} \
      --normalize any2math  # –æ–ø—Ü–∏—è –¥–ª—è –∫–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Any2Math
```

#### –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —É–ª—É—á—à–µ–Ω–∏–π

- [ ] **PCQ/PCE –∫–∞–∫ —Ç–µ—Ä–º—ã**: –§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å PCQ/œÑ –∏ witness-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä—è–º–æ –≤ Any2Math (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–æ–¥–ø–∏—Å—å –≤ proof)
- [ ] **–ë–æ–ª—å—à–µ –ø—Ä–∞–≤–∏–ª**: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ idempotence/–ª–æ–≥-–∞–ª–≥–µ–±—Ä—É –∏–∑ "metrics TRS" –≤ Any2Math, —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä—ã
- [ ] **–û–Ω–ª–∞–π–Ω-–ø—Ä–æ–≤–µ—Ä–∫–∞ (sampling)**: –ù–∞ N% PR –≤ CI –∑–∞–ø—É—Å–∫–∞—Ç—å Lean-–ø—Ä–æ–≤–µ—Ä–∫—É proof-–æ–±—ä–µ–∫—Ç–∞ (–ø—Ä–∏–µ–º–ª–µ–º–∞—è —Ü–µ–Ω–∞, –≤—ã—Å–æ—á–∞–π—à–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
- [ ] **SHACL-Rules ‚Üî TRS**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ (SHACL/SPARQL) –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ (TRS) —Ä–µ–¥—É–∫—Ü–∏–∏ –≤ –æ–¥–∏–Ω pipeline —Å —Ç—Ä–µ–π—Å–∏–Ω–≥–æ–º

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π TCB (Trusted Computing Base)

- **Lean kernel** (–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- **Any2Math –±–∏–Ω–∞—Ä–Ω–∏–∫** (–¥–æ–∫–∞–∑–∞–Ω–Ω—ã–π TRS)
- **Python I/O-–∞–¥–∞–ø—Ç–µ—Ä** (–±–µ–∑ –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è)

‚Üí –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π TCB, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å.

- name: Validate ZAG Attestation
  run: |
    repoq zag validate gate-result.json
```

### –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ë–ª–æ–∫–µ—Ä—ã |
|-----------|------------|-----------|---------|
| `zag.py` (SDK) | 95% | P1 | –ù—É–∂–Ω–∞ ZAG API key |
| Schemas (PCQ/PCE) | 100% | P1 | –ù–µ—Ç (–≥–æ—Ç–æ–≤–æ) |
| `certs/quality.py` | 90% | P1 | –¢–µ—Å—Ç—ã —Å ZAG backend |
| Dockerfile | 85% | P2 | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ |
| CI/CD workflow | 80% | P1 | GitHub secrets setup |
| `repoq.yaml` | 75% | P1 | Calibration –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ |

### –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**Week 2-3** (Priority 1 ‚Äî ZAG PCQ):
1. –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `integrations/zag.py` ‚Üí `repoq/integrations/`
2. –î–æ–±–∞–≤–∏—Ç—å `zag_schemas/` ‚Üí `repoq/schemas/`
3. –û–±–Ω–æ–≤–∏—Ç—å `repoq/quality.py`: –¥–æ–±–∞–≤–∏—Ç—å PCQ/$\min$ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å witness generation –≤ `repoq/gate.py`
5. –¢–µ—Å—Ç—ã: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZAG mock

**Week 3-4** (Priority 1 ‚Äî PCE Witness):
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `generate_witness(k=5)` –¥–ª—è top-k hotspots
2. –î–æ–±–∞–≤–∏—Ç—å remediation plan –≤ gate output
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ PR comments (bot)

**Week 4-5** (Priority 2 ‚Äî Production):
1. Dockerfile –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
2. GitHub Actions workflow ‚Üí `.github/workflows/quality-gate.yml`
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å secrets –¥–ª—è ZAG API

---

## 3. –°–≤—è–∑—å —Å –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

### 3.1 Ontology Alignment Report

–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ `tmp/` –Ω–∞–ø—Ä—è–º—É—é —Ä–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ `ontology-alignment-report.md`:

| –ü—Ä–æ–±–ª–µ–º–∞ (–∏–∑ –æ—Ç—á—ë—Ç–∞) | –†–µ—à–µ–Ω–∏–µ (–≤ tmp/) | –§–∞–π–ª—ã |
|----------------------|------------------|-------|
| ‚ùå Safety Guards 0% | ‚úÖ TRS engine + SHACL guards | `trs/engine.py`, `shapes/meta_loop.ttl` |
| ‚ùå Ontological Integration 0% | ‚úÖ Three-Ontology Architecture | `ontologies/{code,c4,ddd}.ttl` |
| ‚ùå Meta-Loop 0% | ‚úÖ CLI meta extensions | `cli_meta.py`, `sparql/*.rq` |
| ‚ö†Ô∏è ZAG PCQ/PCE missing | ‚úÖ Full ZAG integration | `zag_repoq-finished/` (51 —Ñ–∞–π–ª) |

### 3.2 Quality Loop Roadmap

–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç **–≤—Å–µ —Ñ–∞–∑—ã MVP + Production**:

| –§–∞–∑–∞ (–∏–∑ roadmap) | –ü–æ–∫—Ä—ã—Ç–∏–µ | –§–∞–π–ª—ã |
|-------------------|----------|-------|
| Week 1: Core Gate | ‚úÖ 100% (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ) | `repoq/gate.py` (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥) |
| Week 2: CI Integration | ‚úÖ 90% | `.github/workflows/repoq.yml` |
| Week 3: Policy Config | ‚úÖ 80% | `repoq.yaml` (ZAG manifest) |
| Week 4+: ZAG PCQ | ‚úÖ 95% | `zag_repoq-finished/integrations/` |
| Month 2: Ontology | ‚úÖ 70% | `repoq-meta-loop-addons/ontologies/` |
| Month 3: Meta-Loop | ‚úÖ 60% | `repoq-meta-loop-addons/sparql/`, `trs/` |

### 3.3 Mathematical Proof

–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ `mathematical-proof-quality-monotonicity.md`:

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ (¬ß11 –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞) | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –§–∞–π–ª—ã |
|----------------------------------|------------|-------|
| PCQ/$\min$ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä | ‚úÖ –ì–æ—Ç–æ–≤–æ | `certs/quality.py` |
| $\varepsilon$-calibration | ‚úÖ –ì–æ—Ç–æ–≤–æ | `repoq.yaml` (epsilon config) |
| Witness generation (top-k) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `certs/quality.py::generate_witness()` |
| SHACL –¥–ª—è VC/PCQ | ‚úÖ –ì–æ—Ç–æ–≤–æ | `shapes/shacl_cert.ttl` |
| TRS confluence check | ‚úÖ –ì–æ—Ç–æ–≤–æ | `trs/engine.py::check_confluence()` |

### 3.4 Formal Foundations Complete

–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç **Section 15** (Meta-Loop Integration) –∏–∑ `formal-foundations-complete.md`:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç (¬ß15) | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –§–∞–π–ª—ã |
|-----------------|------------|-------|
| Stratified Self-Application (¬ß15.1) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `trs/engine.py`, `shapes/meta_loop.ttl` |
| Three-Ontology Architecture (¬ß15.3) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `ontologies/{code,c4,ddd}.ttl` |
| SPARQL Construct Mappings (Th. 15.1) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `sparql/inference_construct.rq` |
| Meta-Quality Loop (¬ß15.4) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `cli_meta.py::meta_quality_loop()` |
| **Any2Math Integration (¬ß15.9)** | ‚úÖ –ì–æ—Ç–æ–≤–æ | `repoq-any2math-integration/` (7 —Ñ–∞–π–ª–æ–≤) |
| Proof-Carrying Normalization (Th. 15.3) | ‚úÖ –ì–æ—Ç–æ–≤–æ | `integrations/any2math/adapter.py` |
| Œµ-Heartbeat Scheduler | ‚úÖ –ì–æ—Ç–æ–≤–æ | `integrations/any2math/scheduler.py` |
| VC Certificate Enrichment | ‚úÖ –ì–æ—Ç–æ–≤–æ | `plugins/trs_any2math.py` |

---

## 4. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

### –†–∞–∑–º–µ—Ä—ã

```bash
$ du -sh tmp/*
1.2M    tmp/repoq-meta-loop-addons
3.8M    tmp/zag_repoq-finished
```

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤

```bash
$ find tmp -type f | wc -l
70
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º

| –¢–∏–ø —Ñ–∞–π–ª–∞ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|------------|
| `.py` | 28 | –ö–æ–¥ (–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã, CLI, TRS, tests) |
| `.ttl` | 5 | –û–Ω—Ç–æ–ª–æ–≥–∏–∏ + SHACL shapes |
| `.json` / `.jsonld` | 9 | TRS –ø—Ä–∞–≤–∏–ª–∞, JSON-LD –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã, schemas |
| `.yaml` / `.yml` | 3 | ZAG manifest, CI/CD, mappings |
| `.rq` | 2 | SPARQL queries |
| `.md` | 3 | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| –ü—Ä–æ—á–∏–µ | 20 | Dockerfile, Makefile, configs |

### Git tracking

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**: `tmp/` –≤–∫–ª—é—á–µ–Ω–∞ –≤ `.gitignore` (–Ω–µ–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º–∞—è)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**:
- –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤: –æ—Å—Ç–∞–≤–∏—Ç—å –≤ `.gitignore`
- –î–ª—è long-term —Ö—Ä–∞–Ω–µ–Ω–∏—è: —Å–æ–∑–¥–∞—Ç—å `tmp/.gitkeep` –∏ **–∏—Å–∫–ª—é—á–∏—Ç—å** `tmp/` –∏–∑ `.gitignore`
- –î–ª—è production-ready: **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏** –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

---

## 5. Roadmap –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—Å–≤–æ–¥–∫–∞)

### Priority 0 (Week 1) ‚Äî Safety Guards

**–ò—Å—Ç–æ—á–Ω–∏–∫**: `repoq-meta-loop-addons/`

- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `trs/engine.py` ‚Üí `repoq/core/trs.py`
- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `shapes/meta_loop.ttl` ‚Üí `repoq/shapes/`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `SelfApplicationGuard` –≤ `repoq/gate.py`:
  ```python
  class SelfApplicationGuard:
      def __init__(self, stratification_level: int = 0):
          self.level = stratification_level
          self.read_only = True
      
      def check_safe(self, target_path: Path) -> bool:
          """–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –≤—ã—à–µ level 2."""
          if self.level > 2:
              raise ValueError("Max stratification level is 2")
          return not target_path.is_relative_to(Path(__file__).parent)
  ```
- [ ] –¢–µ—Å—Ç—ã: `tests/test_safety.py` (–∏–∑ `test_self_policy.py`)

**–ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, SHACL –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

### Priority 1 (Week 2-4) ‚Äî ZAG + Basic Ontology

**–ò—Å—Ç–æ—á–Ω–∏–∫**: `zag_repoq-finished/` + `repoq-meta-loop-addons/`

**ZAG Integration**:
- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `integrations/zag.py` ‚Üí `repoq/integrations/`
- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `zag_schemas/` ‚Üí `repoq/schemas/zag/`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `repoq/quality.py`: –¥–æ–±–∞–≤–∏—Ç—å `compute_pcq(modules, aggregator="min")`
- [ ] –î–æ–±–∞–≤–∏—Ç—å `--zag-manifest` –æ–ø—Ü–∏—é –≤ `repoq gate`
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è witness –≤ `repoq/gate.py::format_gate_report()`

**Basic Ontology**:
- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `ontologies/code.ttl` ‚Üí `repoq/ontologies/`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `repoq/ontology/manager.py::BasicOntologyManager`
- [ ] Pattern detection: 5-7 –±–∞–∑–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (MVC, Layered, Plugin)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Q-–º–µ—Ç—Ä–∏–∫—É: `Q += 5 * architectural_bonus`

**–ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: `repoq gate` —Å ZAG —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è

### Priority 2 (Month 2-3) ‚Äî Full Ontology + Meta-Loop

**–ò—Å—Ç–æ—á–Ω–∏–∫**: `repoq-meta-loop-addons/`

- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `ontologies/{c4,ddd}.ttl` ‚Üí `repoq/ontologies/`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `SemanticInferenceEngine` —Å SPARQL
- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å `sparql/*.rq` ‚Üí `repoq/sparql/`
- [ ] Cross-ontology –º–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ `mappings.yaml`
- [ ] CLI extensions: `repoq meta-self`, `repoq trs-verify`

**–ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: Self-improvement recommendations –≤ gate output

---

## 6. –†–∏—Å–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

1. **API Keys**: ZAG integration —Ç—Ä–µ–±—É–µ—Ç API keys (–Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ tmp/)
   - **Mitigation**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock –≤ dev, secrets –≤ CI/CD

2. **Performance**: TRS engine –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –Ω–∞ –±–æ–ª—å—à–∏—Ö –ø—Ä–∞–≤–∏–ª–∞—Ö
   - **Mitigation**: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º

3. **Breaking Changes**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è tmp/ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
   - **Mitigation**: Feature flags, –ø–æ—ç—Ç–∞–ø–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏

1. **Ontology Complexity**: Three-Ontology Architecture –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ–π
   - **Mitigation**: –ù–∞—á–∞—Ç—å —Å Code Ontology, –¥–æ–±–∞–≤–ª—è—Ç—å C4/DDD –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

2. **ZAG Dependency**: –í–Ω–µ—à–Ω—è—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç ZAG —Å–µ—Ä–≤–∏—Å–∞
   - **Mitigation**: Graceful degradation –±–µ–∑ ZAG

3. **Documentation Drift**: tmp/ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ—Ç—å
   - **Mitigation**: –≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî single source of truth

---

## 7. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

### –ü–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã (`pytest tests/`)
- [ ] –°–æ–∑–¥–∞—Ç—å feature branch: `feature/tmp-integration-<component>`
- [ ] –°–¥–µ–ª–∞—Ç—å backup: `cp -r tmp/ tmp_backup_$(date +%Y%m%d)/`

### –í–æ –≤—Ä–µ–º—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [ ] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É (TRS ‚Üí SHACL ‚Üí ZAG ‚Üí Ontology)
- [ ] –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: –∑–∞–ø—É—Å–∫–∞—Ç—å `pytest` + `ruff check`
- [ ] –û–±–Ω–æ–≤–ª—è—Ç—å `pyproject.toml` dependencies
- [ ] –û–±–Ω–æ–≤–ª—è—Ç—å `docs/` –ø–æ –º–µ—Ä–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π test suite (`pytest --cov=repoq`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å coverage: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ‚â•80%
- [ ] –û–±–Ω–æ–≤–∏—Ç—å README.md —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
- [ ] –°–æ–∑–¥–∞—Ç—å migration guide –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## 8. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å tmp/ –≤ Git**:
   ```bash
   # –û–ø—Ü–∏—è A: –î–æ–±–∞–≤–∏—Ç—å –≤ Git –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
   git add tmp/
   git commit -m "chore: –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å tmp/ —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏ –¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
   
   # –û–ø—Ü–∏—è B: –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤ –¥–ª—è backup
   tar -czf tmp_artifacts_$(date +%Y%m%d).tar.gz tmp/
   ```

2. **–°–æ–∑–¥–∞—Ç—å GitHub Project –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**:
   - Milestone: "TMP Artifacts Integration"
   - Issues –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Priority 0/1/2 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   - Tracking: Kanban board (TODO ‚Üí In Progress ‚Üí Done)

3. **–ù–∞—á–∞—Ç—å —Å Priority 0 (Safety Guards)**:
   ```bash
   git checkout -b feature/safety-guards-integration
   cp tmp/repoq-meta-loop-addons/trs/engine.py repoq/core/trs.py
   # ... –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ roadmap
   ```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

- **Month 1**: Priority 0 + Priority 1 (ZAG)
- **Month 2**: Priority 1 (Ontology) + Priority 2 (partial)
- **Month 3**: Priority 2 (full) + production hardening
- **Month 4**: Meta-loop self-improvement + monitoring

---

## 9. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

| –ê—Ç—Ä–∏–±—É—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–°–æ–∑–¥–∞–Ω** | 2025-10-21 |
| **–ê–≤—Ç–æ—Ä** | URPKS Meta-Programmer |
| **–í–µ—Ä—Å–∏—è** | 1.0 |
| **–°—Ç–∞—Ç—É—Å** | üîÑ Living Document |
| **–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã** | `ontology-alignment-report.md`, `quality-loop-roadmap.md`, `mathematical-proof-quality-monotonicity.md` |
| **Git tracking** | ‚ö†Ô∏è –ü–æ–∫–∞ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è (–≤ `.gitignore`) |
| **–†–∞–∑–º–µ—Ä tmp/** | 5.0 MB (70 —Ñ–∞–π–ª–æ–≤) |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `tmp/` —Å–æ–¥–µ—Ä–∂–∏—Ç **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–π –æ–Ω—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –º–µ—Ç–∞-–ø–µ—Ç–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ ZAG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏. –í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–ª–∞–Ω–æ–º –∏–∑ `ontology-alignment-report.md`.

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- ‚úÖ TRS engine —Å —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –≥–∞—Ä–∞–Ω—Ç–∏—è–º–∏ (confluence, termination)
- ‚úÖ Three-Ontology Architecture (Code/C4/DDD)
- ‚úÖ ZAG PCQ/PCE full integration (95% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏)
- ‚úÖ SHACL shapes –¥–ª—è self-application guard
- ‚úÖ CI/CD workflows –¥–ª—è production

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ù–∞—á–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Priority 0 (Safety Guards) –ø–æ roadmap –≤—ã—à–µ.

---

**–ü–æ–¥–ø–∏—Å—å**: URPKS Meta-Programmer  
**–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**: Inventory Complete ‚úÖ  
**–°—Ç–∞—Ç—É—Å**: üì¶ Ready for Integration
